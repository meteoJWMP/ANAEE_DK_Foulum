abline(h=0)
axis(1, at=xaxis,
labels=xlabels)
axis(2, at=0, lwd=0, labels="", line=1.3)
axis(2, at=seq(round(ymin,0),round(ymax,0),5), labels=seq(round(ymin,0),round(ymax,0),5), las=1)   # Major labels
axis(2, at=seq(round(ymin,0),round(ymax,0),5)+2.5, labels=NA, las=1, tck=-0.01)         #minor Labels
legend(x=xaxis[1], y=ymax, col=c("blue", "green"), pch=c(20,20,20),cex=1, bty="n",
legend=c("Dark (RE)", "Light minus dark (GPP)"))
############################################
### ch2
############################################
# Chamber has changed plot name 2 times
dd2 <- subset(liCO2, plot=="A2_Grass2018"|plot=="A2")
# generic plot
with(dd2[which(dd2$LM.flux.flag<3 & dd2$Cdry < 460),], plot(GEP~chrontime, col="green", xaxt="n", xlab="Date",
xlim = xlimits, ylim=c(ymin,ymax), yaxt="n", ylab="µmol CO2 m-2s-1", pch=20, main = "LI8100 CO2 fluxes - ch2"))
with(dd2[which(dd2$LM.flux.flag<3),], points(RE~chrontime, col="blue", pch=20))
abline(h=0)
axis(1, at=xaxis,
labels=xlabels)
axis(2, at=0, lwd=0, labels="", line=1.3)
axis(2, at=seq(round(ymin,0),round(ymax,0),5), labels=seq(round(ymin,0),round(ymax,0),5), las=1)   # Major labels
axis(2, at=seq(round(ymin,0),round(ymax,0),5)+2.5, labels=NA, las=1, tck=-0.01)         #minor Labels
legend(x=xaxis[1], y=ymax, col=c("blue", "green"), pch=c(20,20,20),cex=1, bty="n",
legend=c("Dark (RE)", "Light minus dark (GPP)"))
############################################
### ch3
############################################
# Chamber has changed plot name 2 times
dd3 <- subset(liCO2, plot=="A3_Grass2012"|plot=="A3")
# generic plot
with(dd3[which(dd3$LM.flux.flag<3 & dd3$Cdry < 460),], plot(GEP~chrontime, col="green", xaxt="n", xlab="Date",
xlim = xlimits, ylim=c(ymin,ymax), yaxt="n", ylab="µmol CO2 m-2s-1", pch=20, main = "LI8100 CO2 fluxes - ch3"))
with(dd3[which(dd3$LM.flux.flag<3),], points(RE~chrontime, col="blue", pch=20))
abline(h=0)
axis(1, at=xaxis,
labels=xlabels)
axis(2, at=0, lwd=0, labels="", line=1.3)
axis(2, at=seq(round(ymin,0),round(ymax,0),5), labels=seq(round(ymin,0),round(ymax,0),5), las=1)   # Major labels
axis(2, at=seq(round(ymin,0),round(ymax,0),5)+2.5, labels=NA, las=1, tck=-0.01)         #minor Labels
legend(x=xaxis[1], y=ymax, col=c("blue", "green"), pch=c(20,20,20),cex=1, bty="n",
legend=c("Dark (RE)", "Light minus dark (GPP)"))
############################################
### ch4
############################################
# Chamber has changed plot name 2 times
dd5 <- subset(liCO2, plot=="A4_Grass2012"|plot=="A4")
# generic plot
with(dd5[which(dd5$LM.flux.flag<3 & dd5$Cdry < 460),], plot(GEP~chrontime, col="green", xaxt="n", xlab="Date",
xlim = xlimits, ylim=c(ymin,ymax), yaxt="n", ylab="µmol CO2 m-2s-1", pch=20, main = "LI8100 CO2 fluxes - ch4"))
with(dd5[which(dd5$LM.flux.flag<3),], points(RE~chrontime, col="blue", pch=20))
abline(h=0)
axis(1, at=xaxis,
labels=xlabels)
axis(2, at=0, lwd=0, labels="", line=1.3)
axis(2, at=seq(round(ymin,0),round(ymax,0),5), labels=seq(round(ymin,0),round(ymax,0),5), las=1)   # Major labels
axis(2, at=seq(round(ymin,0),round(ymax,0),5)+2.5, labels=NA, las=1, tck=-0.01)         #minor Labels
legend(x=xaxis[1], y=ymax, col=c("blue", "green"), pch=c(20,20,20),cex=1, bty="n",
legend=c("Dark (RE)", "Light minus dark (GPP)"))
############################################
### ch5
############################################
# Chamber has changed plot name 2 times
dd5 <- subset(liCO2,plot=="A5_Triticale"|plot=="A5")
# generic plot
with(dd5[which(dd6$LM.flux.flag<3 & dd6$Cdry < 460),], plot(GEP~chrontime, col="green", xaxt="n", xlab="Date",
xlim = xlimits, ylim=c(ymin,ymax), yaxt="n", ylab="µmol CO2 m-2s-1", pch=20, main = "LI8100 CO2 fluxes - ch5"))
with(dd5[which(dd6$LM.flux.flag<3),], points(RE~chrontime, col="blue", pch=20))
abline(h=0)
axis(1, at=xaxis,
labels=xlabels)
axis(2, at=0, lwd=0, labels="", line=1.3)
axis(2, at=seq(round(ymin,0),round(ymax,0),5), labels=seq(round(ymin,0),round(ymax,0),5), las=1)   # Major labels
axis(2, at=seq(round(ymin,0),round(ymax,0),5)+2.5, labels=NA, las=1, tck=-0.01)         #minor Labels
legend(x=xaxis[1], y=ymax, col=c("blue", "green"), pch=c(20,20,20),cex=1, bty="n",
legend=c("Dark (RE)", "Light minus dark (GPP)"))
############################################
### ch6
############################################
# Chamber has changed plot name 2 times
dd6 <- subset(liCO2,plot=="A6_Triticale"|plot=="A6")
# generic plot
with(dd6[which(dd2$LM.flux.flag<3 & dd2$Cdry < 460),], plot(GEP~chrontime, col="green", xaxt="n", xlab="Date",
xlim = xlimits, ylim=c(ymin,ymax), yaxt="n", ylab="µmol CO2 m-2s-1", pch=20, main = "LI8100 CO2 fluxes - ch6"))
with(dd2[which(dd6$LM.flux.flag<3),], points(RE~chrontime, col="blue", pch=20))
abline(h=0)
axis(1, at=xaxis,
labels=xlabels)
axis(2, at=0, lwd=0, labels="", line=1.3)
axis(2, at=seq(round(ymin,0),round(ymax,0),5), labels=seq(round(ymin,0),round(ymax,0),5), las=1)   # Major labels
axis(2, at=seq(round(ymin,0),round(ymax,0),5)+2.5, labels=NA, las=1, tck=-0.01)         #minor Labels
legend(x=xaxis[1], y=ymax, col=c("blue", "green"), pch=c(20,20,20),cex=1, bty="n",
legend=c("Dark (RE)", "Light minus dark (GPP)"))
dev.off()
install.packages(agridat)
install.packages("agridat")
agridat::aastveit.barley.covs
agridat::australia.soybean
agridat::welch.bermudagrass
?agridat::welch.bermudagrass
source('O:/ST_AGRO/Klima/JWMP/ANAee_test/R scripts/R folders.R', echo=TRUE)
sitenm <- "Foulum_" # This is used for file names, e.g. filedate 190426 will end as "L2_20190426"
# Always input all the filedates you want to run here. Can be only one file - a few files - or all files - as needed
filedates <- c(190404)
#prior to lightning strike
allfiledates <- c(190404, 190411, 190426, 190501, 190509, 190513, 190516,190520,190521,190522,190527,190529,190602,190607)
require(chron)
load(paste(flaggedfolder, sitenm, "liCO2_180_aggregated_prePAR_flagged_manual.Rdata", sep=""))
# functions to find min and max rounding to certain level. e.g. mceiling(43.13, 2) gives '44'
mfloor <- function(x,base){base*floor(x/base)}
mceiling <- function(x, base){base*ceiling(x/base)}
ymin <- mfloor(min(liCO2$GEP, na.rm=T), 5)
ymax <- mceiling(max(liCO2$RE, na.rm=T), 5)
xaxis <- seq.dates("03/27/19", "08/03/19", by = "weeks")
xlabels <- chron(xaxis, format = c(dates = "d/m/y"))#months(xaxis)
xlimits <-c(xaxis[1], xaxis[length(xaxis)])
colchoice <- c("blue", "red")
# Chamber has changed plot name 2 times
dd1 <- subset(liCO2, plot == "A1_Grass2018"|plot=="A1")
# generic plot
with(dd1[which(dd1$LM.flux.flag<3 & dd1$Cdry < 460),], plot(GEP~chrontime, col="green", xaxt="n", xlab="Date",
xlim = xlimits, ylim=c(ymin,ymax), yaxt="n", ylab="µmol CO2 m-2s-1", pch=20, main = "LI8100 CO2 fluxes - ch1"))
with(dd1[which(dd1$LM.flux.flag<3),], points(RE~chrontime, col="blue", pch=20))
abline(h=0)
axis(1, at=xaxis,
labels=xlabels)
axis(2, at=0, lwd=0, labels="", line=1.3)
axis(2, at=seq(round(ymin,0),round(ymax,0),5), labels=seq(round(ymin,0),round(ymax,0),5), las=1)   # Major labels
axis(2, at=seq(round(ymin,0),round(ymax,0),5)+2.5, labels=NA, las=1, tck=-0.01)         #minor Labels
legend(x=xaxis[1], y=ymax, col=c("blue", "green"), pch=c(20,20,20),cex=1, bty="n",
legend=c("Dark (RE)", "Light minus dark (GPP)"))
# Chamber has changed plot name 2 times
dd2 <- subset(liCO2, plot=="A2_Grass2018"|plot=="A2")
# Chamber has changed plot name 2 times
dd5 <- subset(liCO2,plot=="A5_Triticale"|plot=="A5")
# generic plot
with(dd5[which(dd5$LM.flux.flag<3 & dd6$Cdry < 460),], plot(GEP~chrontime, col="green", xaxt="n", xlab="Date",
xlim = xlimits, ylim=c(ymin,ymax), yaxt="n", ylab="µmol CO2 m-2s-1", pch=20, main = "LI8100 CO2 fluxes - ch5"))
# generic plot
with(dd5[which(dd5$LM.flux.flag<3 & dd5$Cdry < 460),], plot(GEP~chrontime, col="green", xaxt="n", xlab="Date",
xlim = xlimits, ylim=c(ymin,ymax), yaxt="n", ylab="µmol CO2 m-2s-1", pch=20, main = "LI8100 CO2 fluxes - ch5"))
with(dd5[which(dd6$LM.flux.flag<3),], points(RE~chrontime, col="blue", pch=20))
with(dd5[which(dd5$LM.flux.flag<3),], points(RE~chrontime, col="blue", pch=20))
abline(h=0)
axis(1, at=xaxis,
labels=xlabels)
axis(2, at=0, lwd=0, labels="", line=1.3)
axis(2, at=seq(round(ymin,0),round(ymax,0),5), labels=seq(round(ymin,0),round(ymax,0),5), las=1)   # Major labels
axis(2, at=seq(round(ymin,0),round(ymax,0),5)+2.5, labels=NA, las=1, tck=-0.01)         #minor Labels
legend(x=xaxis[1], y=ymax, col=c("blue", "green"), pch=c(20,20,20),cex=1, bty="n",
legend=c("Dark (RE)", "Light minus dark (GPP)"))
# Chamber has changed plot name 2 times
dd6 <- subset(liCO2,plot=="A6_Triticale"|plot=="A6")
# Chamber has changed plot name 2 times
dd4 <- subset(liCO2, plot=="A4_Grass2012"|plot=="A4")
# generic plot
with(dd4[which(dd4$LM.flux.flag<3 & dd4$Cdry < 460),], plot(GEP~chrontime, col="green", xaxt="n", xlab="Date",
xlim = xlimits, ylim=c(ymin,ymax), yaxt="n", ylab="µmol CO2 m-2s-1", pch=20, main = "LI8100 CO2 fluxes - ch4"))
with(dd5[which(dd4$LM.flux.flag<3),], points(RE~chrontime, col="blue", pch=20))
abline(h=0)
axis(1, at=xaxis,
labels=xlabels)
axis(2, at=0, lwd=0, labels="", line=1.3)
axis(2, at=seq(round(ymin,0),round(ymax,0),5), labels=seq(round(ymin,0),round(ymax,0),5), las=1)   # Major labels
axis(2, at=seq(round(ymin,0),round(ymax,0),5)+2.5, labels=NA, las=1, tck=-0.01)         #minor Labels
legend(x=xaxis[1], y=ymax, col=c("blue", "green"), pch=c(20,20,20),cex=1, bty="n",
legend=c("Dark (RE)", "Light minus dark (GPP)"))
# Chamber has changed plot name 2 times
dd5 <- subset(liCO2,plot=="A5_Triticale"|plot=="A5")
# generic plot
with(dd5[which(dd5$LM.flux.flag<3 & dd5$Cdry < 460),], plot(GEP~chrontime, col="green", xaxt="n", xlab="Date",
xlim = xlimits, ylim=c(ymin,ymax), yaxt="n", ylab="µmol CO2 m-2s-1", pch=20, main = "LI8100 CO2 fluxes - ch5"))
with(dd5[which(dd5$LM.flux.flag<3),], points(RE~chrontime, col="blue", pch=20))
abline(h=0)
axis(1, at=xaxis,
labels=xlabels)
axis(2, at=0, lwd=0, labels="", line=1.3)
axis(2, at=seq(round(ymin,0),round(ymax,0),5), labels=seq(round(ymin,0),round(ymax,0),5), las=1)   # Major labels
axis(2, at=seq(round(ymin,0),round(ymax,0),5)+2.5, labels=NA, las=1, tck=-0.01)         #minor Labels
legend(x=xaxis[1], y=ymax, col=c("blue", "green"), pch=c(20,20,20),cex=1, bty="n",
legend=c("Dark (RE)", "Light minus dark (GPP)"))
# Chamber has changed plot name 2 times
dd6 <- subset(liCO2,plot=="A6_Triticale"|plot=="A6")
# generic plot
with(dd6[which(dd2$LM.flux.flag<3 & dd2$Cdry < 460),], plot(GEP~chrontime, col="green", xaxt="n", xlab="Date",
xlim = xlimits, ylim=c(ymin,ymax), yaxt="n", ylab="µmol CO2 m-2s-1", pch=20, main = "LI8100 CO2 fluxes - ch6"))
with(dd2[which(dd6$LM.flux.flag<3),], points(RE~chrontime, col="blue", pch=20))
abline(h=0)
axis(1, at=xaxis,
labels=xlabels)
axis(2, at=0, lwd=0, labels="", line=1.3)
axis(2, at=seq(round(ymin,0),round(ymax,0),5), labels=seq(round(ymin,0),round(ymax,0),5), las=1)   # Major labels
axis(2, at=seq(round(ymin,0),round(ymax,0),5)+2.5, labels=NA, las=1, tck=-0.01)         #minor Labels
legend(x=xaxis[1], y=ymax, col=c("blue", "green"), pch=c(20,20,20),cex=1, bty="n",
legend=c("Dark (RE)", "Light minus dark (GPP)"))
dev.off()
# generic plot
with(dd6[which(dd6$LM.flux.flag<3 & dd6$Cdry < 460),], plot(GEP~chrontime, col="green", xaxt="n", xlab="Date",
xlim = xlimits, ylim=c(ymin,ymax), yaxt="n", ylab="µmol CO2 m-2s-1", pch=20, main = "LI8100 CO2 fluxes - ch6"))
with(dd6[which(dd6$LM.flux.flag<3),], points(RE~chrontime, col="blue", pch=20))
abline(h=0)
axis(1, at=xaxis,
labels=xlabels)
axis(2, at=0, lwd=0, labels="", line=1.3)
axis(2, at=seq(round(ymin,0),round(ymax,0),5), labels=seq(round(ymin,0),round(ymax,0),5), las=1)   # Major labels
axis(2, at=seq(round(ymin,0),round(ymax,0),5)+2.5, labels=NA, las=1, tck=-0.01)         #minor Labels
legend(x=xaxis[1], y=ymax, col=c("blue", "green"), pch=c(20,20,20),cex=1, bty="n",
legend=c("Dark (RE)", "Light minus dark (GPP)"))
dev.off()
# Make a plot of each chamber fluxes.
# NB! Currently only flag 1 and 2 and linear fluxes AND GEP before adjustment for light!
require(chron)
load(paste(flaggedfolder, sitenm, "liCO2_180_aggregated_prePAR_flagged_manual.Rdata", sep=""))
# functions to find min and max rounding to certain level. e.g. mceiling(43.13, 2) gives '44'
mfloor <- function(x,base){base*floor(x/base)}
mceiling <- function(x, base){base*ceiling(x/base)}
pdf(file = paste(pdffolder, sitenm, "cham indiv plots.pdf", sep=""), paper = "a4r", width = 15, height = 10)
ymin <- mfloor(min(liCO2$GEP, na.rm=T), 5)
ymax <- mceiling(max(liCO2$RE, na.rm=T), 5)
xaxis <- seq.dates("03/27/19", "08/03/19", by = "weeks")
xlabels <- chron(xaxis, format = c(dates = "d/m/y"))#months(xaxis)
xlimits <-c(xaxis[1], xaxis[length(xaxis)])
colchoice <- c("blue", "red")
############################################
### CH1
############################################
# Chamber has changed plot name 2 times
dd1 <- subset(liCO2, plot == "A1_Grass2018"|plot=="A1")
# generic plot
with(dd1[which(dd1$LM.flux.flag<3 & dd1$Cdry < 460),], plot(GEP~chrontime, col="green", xaxt="n", xlab="Date",
xlim = xlimits, ylim=c(ymin,ymax), yaxt="n", ylab="µmol CO2 m-2s-1", pch=20, main = "LI8100 CO2 fluxes - ch1"))
with(dd1[which(dd1$LM.flux.flag<3),], points(RE~chrontime, col="blue", pch=20))
abline(h=0)
axis(1, at=xaxis,
labels=xlabels)
axis(2, at=0, lwd=0, labels="", line=1.3)
axis(2, at=seq(round(ymin,0),round(ymax,0),5), labels=seq(round(ymin,0),round(ymax,0),5), las=1)   # Major labels
axis(2, at=seq(round(ymin,0),round(ymax,0),5)+2.5, labels=NA, las=1, tck=-0.01)         #minor Labels
legend(x=xaxis[1], y=ymax, col=c("blue", "green"), pch=c(20,20,20),cex=1, bty="n",
legend=c("Dark (RE)", "Light minus dark (GPP)"))
############################################
### ch2
############################################
# Chamber has changed plot name 2 times
dd2 <- subset(liCO2, plot=="A2_Grass2018"|plot=="A2")
# generic plot
with(dd2[which(dd2$LM.flux.flag<3 & dd2$Cdry < 460),], plot(GEP~chrontime, col="green", xaxt="n", xlab="Date",
xlim = xlimits, ylim=c(ymin,ymax), yaxt="n", ylab="µmol CO2 m-2s-1", pch=20, main = "LI8100 CO2 fluxes - ch2"))
with(dd2[which(dd2$LM.flux.flag<3),], points(RE~chrontime, col="blue", pch=20))
abline(h=0)
axis(1, at=xaxis,
labels=xlabels)
axis(2, at=0, lwd=0, labels="", line=1.3)
axis(2, at=seq(round(ymin,0),round(ymax,0),5), labels=seq(round(ymin,0),round(ymax,0),5), las=1)   # Major labels
axis(2, at=seq(round(ymin,0),round(ymax,0),5)+2.5, labels=NA, las=1, tck=-0.01)         #minor Labels
legend(x=xaxis[1], y=ymax, col=c("blue", "green"), pch=c(20,20,20),cex=1, bty="n",
legend=c("Dark (RE)", "Light minus dark (GPP)"))
############################################
### ch3
############################################
# Chamber has changed plot name 2 times
dd3 <- subset(liCO2, plot=="A3_Grass2012"|plot=="A3")
# generic plot
with(dd3[which(dd3$LM.flux.flag<3 & dd3$Cdry < 460),], plot(GEP~chrontime, col="green", xaxt="n", xlab="Date",
xlim = xlimits, ylim=c(ymin,ymax), yaxt="n", ylab="µmol CO2 m-2s-1", pch=20, main = "LI8100 CO2 fluxes - ch3"))
with(dd3[which(dd3$LM.flux.flag<3),], points(RE~chrontime, col="blue", pch=20))
abline(h=0)
axis(1, at=xaxis,
labels=xlabels)
axis(2, at=0, lwd=0, labels="", line=1.3)
axis(2, at=seq(round(ymin,0),round(ymax,0),5), labels=seq(round(ymin,0),round(ymax,0),5), las=1)   # Major labels
axis(2, at=seq(round(ymin,0),round(ymax,0),5)+2.5, labels=NA, las=1, tck=-0.01)         #minor Labels
legend(x=xaxis[1], y=ymax, col=c("blue", "green"), pch=c(20,20,20),cex=1, bty="n",
legend=c("Dark (RE)", "Light minus dark (GPP)"))
############################################
### ch4
############################################
# Chamber has changed plot name 2 times
dd4 <- subset(liCO2, plot=="A4_Grass2012"|plot=="A4")
# generic plot
with(dd4[which(dd4$LM.flux.flag<3 & dd4$Cdry < 460),], plot(GEP~chrontime, col="green", xaxt="n", xlab="Date",
xlim = xlimits, ylim=c(ymin,ymax), yaxt="n", ylab="µmol CO2 m-2s-1", pch=20, main = "LI8100 CO2 fluxes - ch4"))
with(dd4[which(dd4$LM.flux.flag<3),], points(RE~chrontime, col="blue", pch=20))
abline(h=0)
axis(1, at=xaxis,
labels=xlabels)
axis(2, at=0, lwd=0, labels="", line=1.3)
axis(2, at=seq(round(ymin,0),round(ymax,0),5), labels=seq(round(ymin,0),round(ymax,0),5), las=1)   # Major labels
axis(2, at=seq(round(ymin,0),round(ymax,0),5)+2.5, labels=NA, las=1, tck=-0.01)         #minor Labels
legend(x=xaxis[1], y=ymax, col=c("blue", "green"), pch=c(20,20,20),cex=1, bty="n",
legend=c("Dark (RE)", "Light minus dark (GPP)"))
############################################
### ch5
############################################
# Chamber has changed plot name 2 times
dd5 <- subset(liCO2,plot=="A5_Triticale"|plot=="A5")
# generic plot
with(dd5[which(dd5$LM.flux.flag<3 & dd5$Cdry < 460),], plot(GEP~chrontime, col="green", xaxt="n", xlab="Date",
xlim = xlimits, ylim=c(ymin,ymax), yaxt="n", ylab="µmol CO2 m-2s-1", pch=20, main = "LI8100 CO2 fluxes - ch5"))
with(dd5[which(dd5$LM.flux.flag<3),], points(RE~chrontime, col="blue", pch=20))
abline(h=0)
axis(1, at=xaxis,
labels=xlabels)
axis(2, at=0, lwd=0, labels="", line=1.3)
axis(2, at=seq(round(ymin,0),round(ymax,0),5), labels=seq(round(ymin,0),round(ymax,0),5), las=1)   # Major labels
axis(2, at=seq(round(ymin,0),round(ymax,0),5)+2.5, labels=NA, las=1, tck=-0.01)         #minor Labels
legend(x=xaxis[1], y=ymax, col=c("blue", "green"), pch=c(20,20,20),cex=1, bty="n",
legend=c("Dark (RE)", "Light minus dark (GPP)"))
############################################
### ch6
############################################
# Chamber has changed plot name 2 times
dd6 <- subset(liCO2,plot=="A6_Triticale"|plot=="A6")
# generic plot
with(dd6[which(dd6$LM.flux.flag<3 & dd6$Cdry < 460),], plot(GEP~chrontime, col="green", xaxt="n", xlab="Date",
xlim = xlimits, ylim=c(ymin,ymax), yaxt="n", ylab="µmol CO2 m-2s-1", pch=20, main = "LI8100 CO2 fluxes - ch6"))
with(dd6[which(dd6$LM.flux.flag<3),], points(RE~chrontime, col="blue", pch=20))
abline(h=0)
axis(1, at=xaxis,
labels=xlabels)
axis(2, at=0, lwd=0, labels="", line=1.3)
axis(2, at=seq(round(ymin,0),round(ymax,0),5), labels=seq(round(ymin,0),round(ymax,0),5), las=1)   # Major labels
axis(2, at=seq(round(ymin,0),round(ymax,0),5)+2.5, labels=NA, las=1, tck=-0.01)         #minor Labels
legend(x=xaxis[1], y=ymax, col=c("blue", "green"), pch=c(20,20,20),cex=1, bty="n",
legend=c("Dark (RE)", "Light minus dark (GPP)"))
dev.off()
# Make a plot of each chamber fluxes.
# NB! Currently only flag 1 and 2 and linear fluxes AND GEP before adjustment for light!
require(chron)
load(paste(flaggedfolder, sitenm, "liCO2_180_aggregated_prePAR_flagged_manual.Rdata", sep=""))
# functions to find min and max rounding to certain level. e.g. mceiling(43.13, 2) gives '44'
mfloor <- function(x,base){base*floor(x/base)}
mceiling <- function(x, base){base*ceiling(x/base)}
pdf(file = paste(pdffolder, sitenm, "cham indiv plots.pdf", sep=""), paper = "a4r", width = 15, height = 10)
ymin <- mfloor(min(liCO2$GEP, na.rm=T), 5)
ymax <- mceiling(max(liCO2$RE, na.rm=T), 5)
xaxis <- seq.dates("03/27/19", "08/03/19", by = "weeks")
xlabels <- chron(xaxis, format = c(dates = "d/m/y"))#months(xaxis)
xlimits <-c(xaxis[1], xaxis[length(xaxis)])
colchoice <- c("blue", "red")
############################################
### CH1
############################################
# Chamber has changed plot name 2 times
dd1 <- subset(liCO2, plot == "A1_Grass2018"|plot=="A1")
# generic plot
with(dd1[which(dd1$LM.flux.flag<3 & dd1$Cdry < 460),], plot(GEP~chrontime, col="green", xaxt="n", xlab="Date",
xlim = xlimits, ylim=c(ymin,ymax), yaxt="n", ylab="µmol CO2 m-2s-1", pch=20, main = "LI8100 CO2 fluxes - A1"))
with(dd1[which(dd1$LM.flux.flag<3),], points(RE~chrontime, col="blue", pch=20))
abline(h=0)
axis(1, at=xaxis,
labels=xlabels)
axis(2, at=0, lwd=0, labels="", line=1.3)
axis(2, at=seq(round(ymin,0),round(ymax,0),5), labels=seq(round(ymin,0),round(ymax,0),5), las=1)   # Major labels
axis(2, at=seq(round(ymin,0),round(ymax,0),5)+2.5, labels=NA, las=1, tck=-0.01)         #minor Labels
legend(x=xaxis[1], y=ymax, col=c("blue", "green"), pch=c(20,20,20),cex=1, bty="n",
legend=c("Dark (RE)", "Light minus dark (GPP)"))
############################################
### ch2
############################################
# Chamber has changed plot name 2 times
dd2 <- subset(liCO2, plot=="A2_Grass2018"|plot=="A2")
# generic plot
with(dd2[which(dd2$LM.flux.flag<3 & dd2$Cdry < 460),], plot(GEP~chrontime, col="green", xaxt="n", xlab="Date",
xlim = xlimits, ylim=c(ymin,ymax), yaxt="n", ylab="µmol CO2 m-2s-1", pch=20, main = "LI8100 CO2 fluxes - A2"))
with(dd2[which(dd2$LM.flux.flag<3),], points(RE~chrontime, col="blue", pch=20))
abline(h=0)
axis(1, at=xaxis,
labels=xlabels)
axis(2, at=0, lwd=0, labels="", line=1.3)
axis(2, at=seq(round(ymin,0),round(ymax,0),5), labels=seq(round(ymin,0),round(ymax,0),5), las=1)   # Major labels
axis(2, at=seq(round(ymin,0),round(ymax,0),5)+2.5, labels=NA, las=1, tck=-0.01)         #minor Labels
legend(x=xaxis[1], y=ymax, col=c("blue", "green"), pch=c(20,20,20),cex=1, bty="n",
legend=c("Dark (RE)", "Light minus dark (GPP)"))
############################################
### ch3
############################################
# Chamber has changed plot name 2 times
dd3 <- subset(liCO2, plot=="A3_Grass2012"|plot=="A3")
# generic plot
with(dd3[which(dd3$LM.flux.flag<3 & dd3$Cdry < 460),], plot(GEP~chrontime, col="green", xaxt="n", xlab="Date",
xlim = xlimits, ylim=c(ymin,ymax), yaxt="n", ylab="µmol CO2 m-2s-1", pch=20, main = "LI8100 CO2 fluxes - A3"))
with(dd3[which(dd3$LM.flux.flag<3),], points(RE~chrontime, col="blue", pch=20))
abline(h=0)
axis(1, at=xaxis,
labels=xlabels)
axis(2, at=0, lwd=0, labels="", line=1.3)
axis(2, at=seq(round(ymin,0),round(ymax,0),5), labels=seq(round(ymin,0),round(ymax,0),5), las=1)   # Major labels
axis(2, at=seq(round(ymin,0),round(ymax,0),5)+2.5, labels=NA, las=1, tck=-0.01)         #minor Labels
legend(x=xaxis[1], y=ymax, col=c("blue", "green"), pch=c(20,20,20),cex=1, bty="n",
legend=c("Dark (RE)", "Light minus dark (GPP)"))
############################################
### ch4
############################################
# Chamber has changed plot name 2 times
dd4 <- subset(liCO2, plot=="A4_Grass2012"|plot=="A4")
# generic plot
with(dd4[which(dd4$LM.flux.flag<3 & dd4$Cdry < 460),], plot(GEP~chrontime, col="green", xaxt="n", xlab="Date",
xlim = xlimits, ylim=c(ymin,ymax), yaxt="n", ylab="µmol CO2 m-2s-1", pch=20, main = "LI8100 CO2 fluxes - A4"))
with(dd4[which(dd4$LM.flux.flag<3),], points(RE~chrontime, col="blue", pch=20))
abline(h=0)
axis(1, at=xaxis,
labels=xlabels)
axis(2, at=0, lwd=0, labels="", line=1.3)
axis(2, at=seq(round(ymin,0),round(ymax,0),5), labels=seq(round(ymin,0),round(ymax,0),5), las=1)   # Major labels
axis(2, at=seq(round(ymin,0),round(ymax,0),5)+2.5, labels=NA, las=1, tck=-0.01)         #minor Labels
legend(x=xaxis[1], y=ymax, col=c("blue", "green"), pch=c(20,20,20),cex=1, bty="n",
legend=c("Dark (RE)", "Light minus dark (GPP)"))
############################################
### ch5
############################################
# Chamber has changed plot name 2 times
dd5 <- subset(liCO2,plot=="A5_Triticale"|plot=="A5")
# generic plot
with(dd5[which(dd5$LM.flux.flag<3 & dd5$Cdry < 460),], plot(GEP~chrontime, col="green", xaxt="n", xlab="Date",
xlim = xlimits, ylim=c(ymin,ymax), yaxt="n", ylab="µmol CO2 m-2s-1", pch=20, main = "LI8100 CO2 fluxes - A5"))
with(dd5[which(dd5$LM.flux.flag<3),], points(RE~chrontime, col="blue", pch=20))
abline(h=0)
axis(1, at=xaxis,
labels=xlabels)
axis(2, at=0, lwd=0, labels="", line=1.3)
axis(2, at=seq(round(ymin,0),round(ymax,0),5), labels=seq(round(ymin,0),round(ymax,0),5), las=1)   # Major labels
axis(2, at=seq(round(ymin,0),round(ymax,0),5)+2.5, labels=NA, las=1, tck=-0.01)         #minor Labels
legend(x=xaxis[1], y=ymax, col=c("blue", "green"), pch=c(20,20,20),cex=1, bty="n",
legend=c("Dark (RE)", "Light minus dark (GPP)"))
############################################
### ch6
############################################
# Chamber has changed plot name 2 times
dd6 <- subset(liCO2,plot=="A6_Triticale"|plot=="A6")
# generic plot
with(dd6[which(dd6$LM.flux.flag<3 & dd6$Cdry < 460),], plot(GEP~chrontime, col="green", xaxt="n", xlab="Date",
xlim = xlimits, ylim=c(ymin,ymax), yaxt="n", ylab="µmol CO2 m-2s-1", pch=20, main = "LI8100 CO2 fluxes - A6"))
with(dd6[which(dd6$LM.flux.flag<3),], points(RE~chrontime, col="blue", pch=20))
abline(h=0)
axis(1, at=xaxis,
labels=xlabels)
axis(2, at=0, lwd=0, labels="", line=1.3)
axis(2, at=seq(round(ymin,0),round(ymax,0),5), labels=seq(round(ymin,0),round(ymax,0),5), las=1)   # Major labels
axis(2, at=seq(round(ymin,0),round(ymax,0),5)+2.5, labels=NA, las=1, tck=-0.01)         #minor Labels
legend(x=xaxis[1], y=ymax, col=c("blue", "green"), pch=c(20,20,20),cex=1, bty="n",
legend=c("Dark (RE)", "Light minus dark (GPP)"))
dev.off()
source('O:/ST_AGRO/Klima/JWMP/ANAee_test/R scripts/graph each chamber.R', echo=TRUE)
source('O:/ST_AGRO/Klima/JWMP/ANAee_test/R scripts/graph each chamber.R', echo=TRUE)
Sys.setlocale(category = "LC_ALL", locale = "English_United States.1252")
rm(list = ls())
labels_2 <- data.frame(matrix(nrow=12,ncol=4))
names(labels_2) = c("number","depth","subplot","species")
labels_2[1,] <- c("T1","-5","A1","2018 Festulolium")
labels_2[2,] <- c("T2","-20","A1","2018 Festulolium")
labels_2[3,] <- c("T3","-5","Out","2018 Festulolium")
labels_2[4,] <- c("T4","-20","Out","2018 Festulolium")
labels_2[5,] <- c("T5","-5","A2","2018 Festulolium")
labels_2[6,] <- c("T6","-20","A2","2018 Festulolium")
labels_2[7,] <- c("T7","-5","A3","2012 Festulolium")
labels_2[8,] <- c("T8","-20","A3","2012 Festulolium")
labels_2[9,] <- c("T9","-5","Out","2012 Festulolium")
labels_2[10,] <- c("T10","-20","Out","2012 Festulolium")
labels_2[11,] <- c("T11","-5","A4","2012 Festulolium")
labels_2[12,] <- c("T12","-20","A4","2012 Festulolium")
labels_1 <- data.frame(matrix(nrow=12,ncol=4))
names(labels_1) = c("number","depth","subplot","species")
labels_1[1,] <- c("T13","-5","Out","GrassClover")
labels_1[2,] <- c("T14","-20","Out","GrassClover")
labels_1[3,] <- c("T15","-5","Out","GrassClover")
labels_1[4,] <- c("T16","-20","Out","GrassClover")
labels_1[5,] <- c("T17","-5","Out","GrassClover")
labels_1[6,] <- c("T18","-20","Out","GrassClover")
labels_1[7,] <- c("T19","-5","A5","Triticale")
labels_1[8,] <- c("T20","-20","A5","Triticale")
labels_1[9,] <- c("T21","-5","Out","Triticale")
labels_1[10,] <- c("T22","-20","Out","Triticale")
labels_1[11,] <- c("T23","-5","A6","Triticale")
labels_1[12,] <- c("T24","-20","A6","Triticale")
# functions ------------------------------------------------------------
plotting_all_TDR_NEW <- function(x,label=NULL){
x <- x[,c(5:16,65)]
for(i in 1:12){
minimum=floor(min(as.numeric(x[,1]),as.numeric(x[,2]),as.numeric(x[,3]),as.numeric(x[,4]),as.numeric(x[,5]),as.numeric(x[,6]),as.numeric(x[,7]),as.numeric(x[,8]),as.numeric(x[,9]),as.numeric(x[,10]),as.numeric(x[,11]),as.numeric(x[,12]),na.rm = T))
maximum=ceiling(max(as.numeric(x[,1]),as.numeric(x[,2]),as.numeric(x[,3]),as.numeric(x[,4]),as.numeric(x[,5]),as.numeric(x[,6]),as.numeric(x[,7]),as.numeric(x[,8]),as.numeric(x[,9]),as.numeric(x[,10]),as.numeric(x[,11]),as.numeric(x[,12]),na.rm = T))
names(x) <- c(paste("T",seq(1:12),sep=""),"date")
jpeg(filename = paste(i,".jpg",sep=""))
plot(x$date,x[,i],xlab="Time",ylab= "%",type="b",ylim=c(minimum,maximum),main = label[i,])
dev.off()
}
}
plotting_all_temp <- function(x,label=NULL){
x <- x[,c(17:28,65)]
for(i in 1:12){
minimum=floor(min(as.numeric(x[,1]),as.numeric(x[,2]),as.numeric(x[,3]),as.numeric(x[,4]),as.numeric(x[,5]),as.numeric(x[,6]),as.numeric(x[,7]),as.numeric(x[,8]),as.numeric(x[,9]),as.numeric(x[,10]),as.numeric(x[,11]),as.numeric(x[,12]),na.rm = T))
maximum=ceiling(max(as.numeric(x[,1]),as.numeric(x[,2]),as.numeric(x[,3]),as.numeric(x[,4]),as.numeric(x[,5]),as.numeric(x[,6]),as.numeric(x[,7]),as.numeric(x[,8]),as.numeric(x[,9]),as.numeric(x[,10]),as.numeric(x[,11]),as.numeric(x[,12]),na.rm = T))
names(x) <- c(paste("T",seq(1:12),sep=""),"date")
jpeg(filename = paste(i,".jpg",sep=""))
plot(x$date,x[,i],xlab="Time",ylab= "Temperature (degrees C)",type="b",ylim=c(minimum,maximum),main = label[i,])
dev.off()
}
}
plotting_all_Quantum <- function(x){
for(i in 2:ncol(x)){
jpeg(filename = paste(i,".jpg",sep=""))
plot(x$date,x[,i],xlab="Time",ylab=names(x)[i],type="b")
dev.off()
}
}
# MARK 2.1 -------------------------------------------------------------
setwd("//DFS05.UNI.AU.DK//dfs//ST_AGRO//Klima//JWMP//Meteo_figures_Foulum//github//ANAEE_DK_Foulum//Mark_2_1//TDR//")
Mark_2_1_TDR <- read.csv("//DFS05.UNI.AU.DK//dfs//ST_AGRO//Foulumgaard\\AnaEE\\Campbell\\Mark2.1+Router_TDR_Field2_1.dat",skip=1,as.is=T)
Mark_2_1_TDR
setwd("//DFS05.UNI.AU.DK//dfs//ST_AGRO//Klima//JWMP//Meteo_figures_Foulum//github//ANAEE_DK_Foulum//Mark_2_2//TDR//")
Mark_2_2_TDR <- read.csv("//DFS05.UNI.AU.DK//dfs//ST_AGRO//Foulumgaard\\AnaEE\\Campbell\\Mark 2.2 igennem mark 2.1_TDR_Field2_2.dat",skip=1,as.is=T)
Mark_2_2_TDR
